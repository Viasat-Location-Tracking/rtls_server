{% extends 'webapp/base.html' %}
{% load static %}

{% block head %}
{{ block.super }}
<style>
    #myChart {
        background-image: url('{% static 'webapp/chart_bg.png' %}');
        background-size: 100%;
    }

    .clinic-units-text {
        color: red;
    }
</style>
{% endblock head %}

{% block content %}
    <div class="container">
        <div class="row">
            <!-- Map -->
            <div class="col-8">
                <canvas id="myChart"></canvas>
            </div>
            <div class="col-4">
                <!-- Workstation selector -->
                <form>
                    <div class="form-group">
                        <label for="workstation">Pick a workstation:</label>
                        <select class="form-control" id="workstation">
                            {% for workstation in workstations %}
                            <option>{{ workstation }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </form>

                <!-- Move transactions table -->
                <table class="table table-striped table-sm table-bordered my-3">
                    <thead>
                        <tr>
                            <th class="text-center" colspan="3">Move Transactions</th>
                        </tr>
                        <tr>
                            <th style="width:60%">Tag Name</th>
                            <th style="width:40%" colspan="2">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for tag in move_transactions %}
                        <tr>
                            <td>{{ tag.name }}</td>
                            <td>
                                <a class="btn btn-sm btn-success" href="{{ tag.approve_link }}">Approve</a>
                            </td>
                            <td>
                                <a class="btn btn-sm btn-danger" href="{{ tag.deny_link }}">Deny</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row my-3">
            <!-- Daily Pace -->
            <div class="col-3">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title text-center">Daily Pace</h4>
                    </div>
                    <img src="{% static "webapp/success-gauge.jpg" %}" style="width:100%"/>
                </div>
            </div>
            <!-- Units Present -->
            <div class="col-3">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title text-center">Daily Pace</h4>
                    </div>
                    <img src="{% static "webapp/success-gauge.jpg" %}" style="width:100%"/>
                </div>
            </div>
            <div class="col-2">
                <div class="row">
                    <!-- Units Sent to Clinic -->
                    <div class="card mb-2">
                        <div class="card-body">
                            <h6 class="card-title text-center">Units Sent to Clinic</h6>
                            <p class="card-text text-center fs-1">{{ metrics.units_sent_to_clinic }}</p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <!-- Yield -->
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-title text-center">Yield</h6>
                            <p class="card-text text-center fs-1">{{ metrics.yield }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

{% block scripts %}
    {{ block.super }}
    <script src="https://bernii.github.io/gauge.js/dist/gauge.min.js" />

    <script type="text/javascript">
        const labels = [
        'January',
        'February',
        'March',
        'April',
        'May',
        'June',
        ];
        const data = {
            datasets: [{
                label: 'Tag Positions',
                backgroundColor: 'rgb(255, 99, 132)',
                borderColor: 'rgb(255, 99, 132)',
                data: [{
                    x: -10,
                    y: 0
                  }, {
                    x: 0,
                    y: 10
                  }, {
                    x: 10,
                    y: 5
                  }, {
                    x: 0.5,
                    y: 5.5
                }],
            }]
        };
        const config = {
            type: 'scatter',
            data: data,
            options: {
                elements : {
                    point: {
                        radius: 10,
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    x: {
                        display: false,
                        type: 'linear',
                        position: 'bottom',
                        min: -26,
                        max: 20.6
                    },
                    y: {
                        display: false,
                        type: 'linear',
                        position: 'left',
                        min: -10.4,
                        max: 14.4
                    }
                }
            }
        };

        var myChart = new Chart(
            document.getElementById('myChart'),
            config
        );
    </script>

{% endblock scripts %}